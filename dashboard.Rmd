---
title: "Who is Looking for a New Job?"
output: 
  flexdashboard::flex_dashboard:
    runtime: shiny
    orientation: rows
---
```{r setup, include=FALSE}
#^^^NOTE the different header above^^^
#This is because I use a reactive environment on page 3 now

#Incorporating Shiny (interactive) components into flexdashboard:
#https://rmarkdown.rstudio.com/flexdashboard/shiny.html#simple_example
library(flexdashboard)
library(ggplot2)
library(dplyr)
library(RColorBrewer)
library(reshape2)
library(randomForest)


# Set working directory
setwd("~/DRAKE_DEV/SPRING_2021/STAT_190/newJob")

# Read in data
jobs <- read.csv("aug_train.csv")


# Clean Data --------------------------------------------------------------
# Currently any missing value is stored as a blank character, "", rather than NA
# First for each variable we make the missing values = NA
# Then I factor each categorical variable
jobs$enrollee_id[jobs$enrollee_id == ""] <- NA

jobs$city[jobs$city == ""] <- NA
jobs$city <- as.factor(jobs$city)

jobs$city_development_index[jobs$city_development_index == ""] <- NA


jobs$gender[jobs$gender == ""] <- NA
jobs$gender <- as.factor(jobs$gender)

jobs$relevent_experience[jobs$relevent_experience == ""] <- NA
jobs$relevent_experience <- as.factor(jobs$relevent_experience)

jobs$enrolled_university[jobs$enrolled_university == ""] <- NA
jobs$enrolled_university <- as.factor(jobs$enrolled_university)

jobs$education_level[jobs$education_level == ""] <- NA
jobs$education_level <- as.factor(jobs$education_level)

jobs$major_discipline[jobs$major_discipline == ""] <- NA
jobs$major_discipline <- as.factor(jobs$major_discipline)

jobs$experience[jobs$experience == ""] <- NA
jobs$experience <- factor(jobs$experience ,
                          levels = c("<1", "1", "2", "3", "4", "5", "6", "7", "8",
                                     "9", "10", "11", "12", "13", "14", "15", "16",
                                     "17", "18", "19", ">20"))

jobs$company_size[jobs$company_size == ""] <- NA
jobs$company_size <- as.factor(jobs$company_size)

jobs$company_type[jobs$company_type == ""] <- NA
jobs$company_type <- as.factor(jobs$company_type)

jobs$last_new_job[jobs$last_new_job == ""] <- NA
jobs$last_new_job <- as.factor(jobs$last_new_job)

jobs$training_hours[jobs$training_hours == ""] <- NA
jobs$target[jobs$target == ""] <- NA
jobs$target <- as.factor(jobs$target)

# Use na.roughfix to fill in the missing values so there will not be any errors
# when creating the random forest
jobs <- na.roughfix(jobs)
```

Data Overview
===================================== 

Row 
-----------------------------------------------------------------------
### Introduction
This data set consists of data for whether or not a person is interested in leaving
their current job. This data comes from a company who hires their data science teams
by hosting workshops that are open to everyone, with the hope that they will be able
to find outstanding participants to poach from their current company. However, not
everyone who attends these workshops are looking for a job change. These participants
ultimately cause the host to loose money, as they are not getting a potential new
hire from the event. Because of this, the company wants to know whether or not 
a person is looking for a job change so that they can begin to only allow those individuals
to sign up for the workshop

### Research Questions
The ultimate research question for this project is: "Is this person looking for a job
change in the field of data analytics"

In order to answer this question, I will be creating a random forest that will allow
for the host company to predict whether or not a participant is looking for a new job

Row 
-----------------------------------------------------------------------
### Variable Explanation
This data set's y variable is "target" which is 1 if the person is interested in leaving
their current job and 0 if not. This data set also has 13 x variables which are:  
•	enrollee_id: Unique ID for candidate  
•	city: City code  
•	city_ development _index: Development index of the city (scaled)  
•	gender: Gender of candidate  
•	relevent_experience: Relevant experience of candidate  
•	enrolled_university: Type of University course enrolled if any  
•	education_level: Education level of candidate  
•	major_discipline: Education major discipline of candidate  
•	experience: Candidate total experience in years  
•	company_size: No of employees in current employer's company  
•	company_type: Type of current employer  
•	lastnewjob: Difference in years between previous job and current job  
•	training_hours: training hours completed  


### Data Cleaning
There was not much data cleaning that had to be done in order to get this data set
ready to be used. The biggest issue was the large number of missing values. These
missing values were also stored as " " (or just a space), rather than just being left
empty. This meant that for every variable, I had to change the spaces to be the
NA value. I wanted them as NA values so that I could use na.roughfix in order to 
get an average value in there so that my random forest would run without any errors.
In addition, for each categorical variable, I had to make it a factor using as.factor.


Exploratory Analysis
===================================== 

Row
-----------------------------------------------------------------------

### Looking at the relationship between City Development Index and Target
```{r cdiPlot, include=TRUE}
# Looking at City Development Index
ggplot(data = jobs) +
  geom_jitter(aes(x = target, y = city_development_index), alpha = I(.4), colour = "grey") +
  geom_boxplot(aes(x = target, y = city_development_index), alpha = 0) +
  labs(x = "Target", y = "City Development Index") +
  theme_bw()
```


### Looking at the relationship between Training Hours and Target
```{r trainHrsPlot, include=TRUE}
# Looking at number of training hours
ggplot(data = jobs) +
  geom_jitter(aes(x = target, y = training_hours), alpha = I(.4), colour = "grey") +
  geom_boxplot(aes(x = target, y = training_hours), alpha = 0) +
  labs(x = "Target", y = "Number of Training Hours") +
  theme_bw()
```

Row 
-----------------------------------------------------------------------

### Looking at the relationship between Relevent Experience and Target
```{r revExPlot, include=TRUE}
# Looking at relevent experience
ggplot(data = jobs) +
  geom_bar(aes(x = relevent_experience, fill = target), position="fill") +
  ggtitle("Relation of Relevent Experience vs Target") +
  labs(x = "Relevent Experience",
       y = "Proportional Amount") +
  scale_fill_grey("Target") + 
  scale_colour_grey("Target") + 
  theme_bw()

```

### Looking at the relationship between Experience and Target
```{r expPlot, include=TRUE}
# Now just experience
ggplot(data = jobs) +
  geom_bar(aes(x = experience, fill = target), position="fill") +
  ggtitle("Relation of Experience vs Target") +
  labs(x = "Experience",
       y = "Proportional Amount") +
  scale_fill_grey("Target") + 
  scale_colour_grey("Target") + 
  theme_bw()
```

